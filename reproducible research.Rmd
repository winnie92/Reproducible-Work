
Reproducible Research-Peer Assessment 2
---

```{r}

```
Qustion
---
From the NOAA Storm Database, answer the following questions:  

- Across the United States, which types of weather events are most harmful with respect to population health?

- Across the United States, which types of weather events have the greatest economic consequences?  

Analyse Method and ideas
---
- first, pick up the relevant variables indicating the consequences of the two catogories--human injures and economical damages.  
- second, respectively do some statiscal measurements(which event contributes most of the influence on the human health and economy/which event contribute the greatest growth rate?) on the damages data by the groups of different events to indicate the influence of different types of weather events.  
- last, print out or plot out the results.  
 
Data Processing
---
- first, look into the code book and find out the relevant variables:  
1. EVTYPE = Type of storm event.  
2. PROPCASH = Combines the Property damage in whole numbers and hundredths and multiplier where Hundred (H), Thousand (K), Million (M), Billion (B) to create a numeric value.  
3. TOTCASH = combine the total Crop damage.  
4. FATALITIES = Number directly killed.  
5. INJURIES = Number directly injured.
6. BGN_DATE = the date of the event(can be used in calculating the growth rate)
- second, understand what we use.
EVTYPE--the categorical variable we are going to use,  PROPCASH + TOTCASH--the economical impact, FATALITIES + INJURIES--human health impact.  
- third, load the data in R, subset the relevant colums and make their classes and names right.  

```{r}
setwd("F:/")
data0<- read.csv("StormData.csv",stringsAsFactor=FALSE,header=TRUE,quote="")
names(data0)
```  

- we can see that we should pick up the relevant cols and clean up their names and classes.  

```{r}
data1 <- data0[c("X.BGN_DATE.","X.EVTYPE.","X.FATALITIES.","X.INJURIES.","X.PROPDMG.","X.PROPDMGEXP.","X.CROPDMG.","X.CROPDMGEXP.")]
str(data1)
names(data1) <- c("date","type","fatalities","injuries","property","proexp","crop","cropexp")

ty <- read.csv("type.txt")
ty1 <- as.character(ty[,1])
class(ty1)
ty2 <- toupper(ty1)

for(i in 1:length(data1$type)) {
  r <- nchar(data1$type[i])-2
  data1$type[i] <- substr(data1$type[i],2,r)
}
data1$type[50:80]

for(i in 1:length(ty2)){
  data1$type <- ifelse(grepl(ty2[i],data1$type),ty2[i],data1$type)
}
data1$type[50:80]
ty3 <- as.factor(data1$type)
ty3[50:80]
length(levels(ty3))
```  
- using for loops to summarize the factors in the data to 48 types from type.txt  














